syntax = "proto3";

// AuthorisationRequest is a message that is being send while trying to log in to a resource
message AuthorisationRequest {
    string login = 1;
    string password = 2;
    string ip = 3;
}

// Response is a return message that is used by all rpc methods; returns either a boolean response or an error
message Response {
    oneof result {
        bool ok = 1;
        string error = 2;
    }
}

// FlushBucketRequest is a message that contains information on a bucket that needs to be flashed
message FlushBucketRequest {
    string login = 1;
    string ip = 2;
}

// SubnetRequest is a message that is used to request black and white lists actions
message SubnetRequest {
    string login = 1;
    string ip = 2;
}

// Main API for the project
service ABFGuardService {
    // Authorisation .
    rpc Authorisation(AuthorisationRequest) returns (Response) {}
    // FlashBucket .
    rpc FlushBucket(FlushBucketRequest) returns (Response) {}
    // AddIpToWhitelist .
    rpc AddIpToWhitelist(SubnetRequest) returns (Response) {}
    // DeleteIpFromWhitelist .
    rpc DeleteIpFromWhitelist(SubnetRequest) returns (Response) {}
    // AddIpToBlacklist .
    rpc AddIpToBlacklist(SubnetRequest) returns (Response) {}
    // DeleteIpFromBlacklist .
    rpc DeleteIpFromBlacklist(SubnetRequest) returns (Response) {}
}
